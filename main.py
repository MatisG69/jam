import pygame
import random
import sys

# التهيئة
pygame.init()
عرض, ارتفاع = 1920, 1080
نافذة = pygame.display.set_mode((عرض, ارتفاع))
pygame.display.set_caption("Mini Geometry Dash")

# الألوان
أبيض = (255, 255, 255)
أسود = (0, 0, 0)
لون_الأرض = (30, 30, 30)

# تحميل صورة الخلفية
try:
    صورة_الخلفية = pygame.image.load("geometrydash.png")
    صورة_الخلفية = pygame.transform.scale(صورة_الخلفية, (عرض, ارتفاع))
except:
    print("خطأ: صورة geometrydash.png مفقودة!")
    pygame.quit()
    sys.exit()

# تحميل صورة الشخصية
صورة_الشخصية = pygame.image.load("persos.png")  # استبدل بصورتك الشخصية
صورة_الشخصية = pygame.transform.scale(صورة_الشخصية, (80, 60))  # ضبط الحجم حسب الحاجة

# عقبات : صور PNG لاستخدامها
صورة_العقبة = pygame.image.load("obstacle.png")  # استبدل بصورة العقبة
صورة_العقبة = pygame.transform.scale(صورة_العقبة, (100, 80))  # ضبط الحجم

# تحميل صورة القطعة
صورة_القطعة = pygame.image.load("bde.png")  # استبدل بصورة القطعة
صورة_القطعة = pygame.transform.scale(صورة_القطعة, (180, 120))  # ضبط الحجم

# متغيرات الشخصية
موقع_الشخصية_x = 100
موقع_الشخصية_y = ارتفاع - 200
سرعة_الشخصية_y = 0
الجاذبية = 1
هل_القفز = False

# متغيرات العقبات
العقبات = []
سرعة_العقبة = 7
مؤقت_العقبة = 0
تأخير_العقبة = 1500  # بالمللي ثانية

# متغيرات القطع
القطع = []
تأخير_القطعة = 2000  # كل 2 ثانية تظهر قطعة
مؤقت_القطعة = 0

# متغيرات الصعوبة
النقاط = 0
فاصل_زيادة_السرعة = 10  # زيادة السرعة كل 10 نقاط

# الساعة
الساعة = pygame.time.Clock()
الخط = pygame.font.SysFont(None, 48)

def رسم_النافذة(مستطيل_الشخصية, العقبات, القطع):
    # عرض صورة الخلفية
    نافذة.blit(صورة_الخلفية, (0, 0))

    # الأرض
    pygame.draw.rect(نافذة, لون_الأرض, (0, ارتفاع - 50, عرض, 50))

    # الشخصية
    نافذة.blit(صورة_الشخصية, مستطيل_الشخصية)

    # العقبات
    for عقبة in العقبات:
        نافذة.blit(صورة_العقبة, عقبة)

    # القطع
    for قطعة in القطع:
        نافذة.blit(صورة_القطعة, قطعة)

    # عرض النقاط في أعلى اليمين
    نص_النقاط = الخط.render(f"Punteggio {النقاط}", True, أبيض)

    نافذة.blit(نص_النقاط, (عرض - نص_النقاط.get_width() - 10, 10))

    pygame.display.update()

def نهاية_اللعبة():
    global النقاط  # Permet d'accéder à la variable globale 'النقاط'
    النقاط = 0  # Réinitialiser le score à 0 lorsque le jeu est perdu
    نص = الخط.render("Salem Aleykoum", True, أسود)
    نافذة.blit(نص, (عرض // 2 - نص.get_width() // 2, ارتفاع // 2 - 20))
    pygame.display.update()
    pygame.time.wait(2000)

def الرئيسية():
    global موقع_الشخصية_y, سرعة_الشخصية_y, هل_القفز, مؤقت_العقبة, النقاط, سرعة_العقبة, مؤقت_القطعة

    تشغيل = True
    موقع_الشخصية_y = ارتفاع - 90
    سرعة_الشخصية_y = 0
    هل_القفز = False
    العقبات.clear()
    القطع.clear()
    مستطيل_الشخصية = pygame.Rect(موقع_الشخصية_x, موقع_الشخصية_y, 40, 40)

    while تشغيل:
        الساعة.tick(60)
        الوقت_الحالي = pygame.time.get_ticks()

        for حدث in pygame.event.get():
            if حدث.type == pygame.QUIT:
                تشغيل = False

        # القفز
        المفاتيح = pygame.key.get_pressed()
        if المفاتيح[pygame.K_SPACE] and not هل_القفز:
            سرعة_الشخصية_y = -18
            هل_القفز = True

        # الجاذبية
        سرعة_الشخصية_y += الجاذبية
        موقع_الشخصية_y += سرعة_الشخصية_y

        if موقع_الشخصية_y >= ارتفاع - 90:
            موقع_الشخصية_y = ارتفاع - 90
            هل_القفز = False
            سرعة_الشخصية_y = 0

        مستطيل_الشخصية.y = موقع_الشخصية_y

        # العقبات
        if الوقت_الحالي - مؤقت_العقبة > تأخير_العقبة:
            مؤقت_العقبة = الوقت_الحالي
            عقبة_جديدة = pygame.Rect(عرض, ارتفاع - 80, 40, 40)
            العقبات.append(عقبة_جديدة)

        for عقبة in العقبات:
            عقبة.x -= سرعة_العقبة  # سرعة العقبة

        العقبات[:] = [عقبة for عقبة in العقبات if عقبة.x + عقبة.width > 0]

        # القطع
        if الوقت_الحالي - مؤقت_القطعة > تأخير_القطعة:
            مؤقت_القطعة = الوقت_الحالي
            قطعة_جديدة = pygame.Rect(عرض, ارتفاع - 100, 50, 50)  # تظهر في نفس مستوى الشخصية
            القطع.append(قطعة_جديدة)

        for قطعة in القطع:
            قطعة.x -= 5  # سرعة القطعة

        القطع[:] = [قطعة for قطعة in القطع if قطعة.x + قطعة.width > 0]

        # جمع القطع
        for قطعة in القطع:
            if مستطيل_الشخصية.colliderect(قطعة):
                القطع.remove(قطعة)
                النقاط += 1  # زيادة النقاط عند جمع القطعة

        # زيادة السرعة بعد عدد معين من النقاط
        if النقاط > 0 and النقاط % فاصل_زيادة_السرعة == 0:
            سرعة_العقبة = 7 + (النقاط // فاصل_زيادة_السرعة)  # زيادة السرعة
            النقاط += 1  # لتجنب زيادة السرعة مرتين
        else:
            النقاط += 1  # حساب النقاط بشكل طبيعي

        # الاصطدام
        for عقبة in العقبات:
            if مستطيل_الشخصية.colliderect(عقبة):
                نهاية_اللعبة()
                الرئيسية()

        رسم_النافذة(مستطيل_الشخصية, العقبات, القطع)

    pygame.quit()
    sys.exit()

if __name__ == "__main__":
    الرئيسية()
